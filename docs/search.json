{
  "articles": [
    {
      "path": "about.html",
      "title": "About this site",
      "description": "Some additional details about the website",
      "author": [],
      "contents": "\r\n\r\n\r\n\r\n",
      "last_modified": "2024-06-11T23:10:43-04:00"
    },
    {
      "path": "index.html",
      "title": "Phishing with SQL",
      "description": "Welcome to the website. I hope you enjoy it!\n",
      "author": [],
      "contents": "\r\nTaking raw data from this dataset, I’m looking at sales trends for the year\r\nSpanning just under two yeras, this dataset keeps tracks of the weekly sales of certain Walmart stores. there are 45 stores and 10 holidays. it also takes general indicators of the wellbeing of economy and enviormnet - temprarture, CPI, unemployement, and fuel prices.\r\n\r\nimport pandas as pd\r\ndf = pd.read_csv('Walmart_sales.csv', parse_dates=['Date'], dayfirst=False)\r\n\r\n\r\n#sort by store number and then date\r\ndf.sort_values(by=['Store', 'Date'])\r\n\r\n#standarize dates to mm-dd-yyyy\r\ndf['Date'] = pd.to_datetime(df['Date'], format='%d-%m-%Y').dt.strftime('%m-%d-%Y')\r\n\r\n#rounding data \r\ndf.round({'Weekly_Sales':2, 'Temperature':0, 'Fuel_Price':2, 'CPI':3, 'Unemployment':3})\r\n\r\n#removing missing values\r\ndf.dropna\r\n\r\n#create cleaned csv\r\ndf.to_csv('./WalmartSalesClean.csv')\r\n\r\nafter cleaning, the information appears as so:\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nLet’s answer a few questions about the data. We’ll be using SQL to clean and manipulate the data.\r\nWhich holidays affect weekly sales the most?\r\n\r\nALTER TABLE WalmartSalesClean\r\nALTER COLUMN Holiday_Flag Int;\r\n\r\nSELECT Date, SUM(CAST(Weekly_Sales AS FLOAT)) AS Weekly_Sales\r\nFROM WalmartSalesClean \r\nWHERE Holiday_Flag='1'\r\nGROUP BY Date\r\nORDER BY Weekly_Sales DESC;\r\n\r\nSELECT Holiday_Flag = '1', Date, SUM(CAST(Weekly_Sales AS FLOAT)) AS Weekly_Sales\r\nFROM WalmartSalesClean\r\nGROUP BY Date\r\nORDER BY Weekly_Sales DESC;\r\n\r\nWhich stores in the dataset have the lowest and highest unemployment rate? What factors do you think are impacting the unemployment rate?\r\n\r\n\r\n\r\nWITH corrdata AS (\r\nSELECT Store, avg(CAST(Unemployment AS decimal)) AS Unemployment, avg(CAST(Temperature AS decimal)) AS Temperature, avg(CAST(Fuel_Price AS decimal)) AS Fuel_Prices, avg(CAST(CPI AS decimal)) AS CPI, avg(CAST(Weekly_Sales AS decimal)) AS Weekly_Sales\r\nFROM WalmartSalesClean\r\nGROUP BY Store\r\n/*ORDER BY Unemployment desc, Weekly_Sales */\r\n\r\nPearson’s correlation\r\n\r\nrawdata AS (\r\nSELECT Unemployment AS x, Weekly_Sales AS y, Unemployment*Weekly_Sales AS xy, Unemployment*Unemployment AS xsquared, Weekly_Sales*Weekly_Sales AS ysquared  \r\nFROM corrdata\r\n),\r\n\r\npdata AS (\r\nSELECT SUM(x) AS sumx, SUM(y) AS sumy, SUM(xy) as sumxy, SUM(xsquared) as sumx2, SUM(ysquared) as sumy2, COUNT(x) as n\r\nFROM rawdata\r\n)\r\n\r\nSELECT (n*sumxy - sumx * sumy) / (sqrt((n*sumx2 - sumx*sumx)*(n*sumy2 - sumy*sumy))) AS \"Pearson's Correlation\"\r\nFROM pdata\r\n\r\nIs there any correlation between CPI and Weekly Sales? How does the correlation differ when the Holiday Flag is 0 versus when the Holiday Flag is 1?\r\n\r\n\r\n\r\nWITH rdata AS (\r\nSELECT CAST(ROUND(CPI, 0) AS INT) AS CPI, CAST(Weekly_Sales AS decimal) AS Weekly_Sales\r\nFROM WalmartSalesClean\r\nWHERE Holiday_Flag = 0\r\n),\r\n\r\ncorrdata AS(\r\nSELECT CPI, AVG(Weekly_Sales) AS Weekly_Sales\r\nFROM rdata\r\nGROUP BY CPI\r\n/*ORDER BY CPI ASC*/\r\n),\r\n\r\n\r\nrawdata AS (\r\nSELECT CPI AS x, Weekly_Sales AS y, CPI*Weekly_Sales AS xy, CPI*CPI AS xsquared, Weekly_Sales*Weekly_Sales AS ysquared  \r\nFROM corrdata\r\n),\r\n\r\npdata AS (\r\nSELECT SUM(x) AS sumx, SUM(y) AS sumy, SUM(xy) as sumxy, SUM(xsquared) as sumx2, SUM(ysquared) as sumy2, COUNT(x) as n\r\nFROM rawdata\r\n)\r\n\r\nSELECT (n*sumxy - sumx * sumy) / (sqrt((n*sumx2 - sumx*sumx)*(n*sumy2 - sumy*sumy))) AS \"Pearson's Correlation\"\r\nFROM pdata\r\n\r\nhttps://docs.google.com/spreadsheets/d/1JNzGqUo9HEn5WOKftEgcm94JddOK6G3_QW-UI4sFNUY/edit#gid=0\r\n\r\n\r\n\r\n",
      "last_modified": "2024-06-11T23:10:42-04:00"
    }
  ],
  "collections": []
}
